# CarND-Path-Planning-Project Model Documentation
A Path Planner for Highway driving

[//]: # (Image References)

[video1]: ./video_output/path_planner.mov "VideoPathPlanner"
[image1]: ./images/lane_changing.png "lane changing"
[image2]: ./images/speed_limit.png "speed limit"
[image3]: ./images/end_point.png "end point"
[image4]: ./images/path_planning.png "path_planning"

---

## The Path Planner

A Path planner has been implementaed for Highway Driving. The path planner creates a smooth, safe path for the car to follow along a 3 lane highway with traffic. The car remains inside a lane, tries to run a max speed of 50MPH, decide and pass a slower moving vehicle ahead. Obviously the car does not bump into another car.

The path planner is written in main.cpp. It receives the car's location data, sensor fusion data from the simulator. It creates a list of points in x and y , that the car in the simulator will visit every .02 seconds.

The path planner has a behavioral planning part and a Trajectory geneation part. The Behavioral planning is implemented in a Finite State Machine. At each step, it creates a list of possible possible states based on the current state of the car. Then, for each possible future state, it calculates the cost of implementating that state transition. Then it chhoses the state associated with lowest cost. 
Then the Trajectory generation part of the path planner creates a trajectory for the chosen state. It creates a list of 50 x and y points(next_x_vals and next_y_vals), for the simulator to follow. The simulator executes each (x,y) point every 0.02 sec.



## Valid Trajectories

### The car is able to drive at least 4.32 miles without incident..

The Car drives along the highway for more than 4.32 miles without incident. 

![alt text][image3]

### The car drives according to the speed limit.

The car never exceeds the speed limit of 50 MPH. Whenever possible, it tries to run at close to the speed limit. If there is a slow moving car in front and side lanes are blocked by other cars, such that safe lane change is not possible, the car follows the car in front or slows down to look for a gap in side lane for lane changing.

![alt text][image2]

### Max Acceleration and Jerk are not Exceeded

The path planner receives the x and y points generated by the path planner in the last step and not consumed by the car in the simulator yet(previous_path_x and previous_path_y). For generating smooth path, the trajectory generator takes those lists and appends new points at the end according to the new trajectory geneartion plan. 
Also, after fitting a spline for the future trajecory, the trajecory generator smoothens the x corodinate points.
This way the trajectory generator ensures that Max Acceleration and Jerk is not exceeded. 


### Car does not have collisions.

The car remains at its lane if it can drive at close to speed limit. If there is a slow moving vehicle ahead, the FSM of the path planner looks for the possibility of left or right lane change. If there is no car on other lanes and it is safe to move into other lanes, the car moves to other lanes. If left and right lanes are blocked by other vehicles, the car keeps following the car in front and waits for safe lane changing opportunity.

### The car stays in its lane, except for the time between changing lanes.

The car remains in lane except for the time of lane changing.

### The car is able to change lanes

If there is a slow moving vehicle in from of the car, the FSM of the path planner calculates cost of following the car at slower speed and also, for left and right lane change trajectories. Cost of a lane change trajectory is higher if there are other cars on those lanes. So, only when the path planner determines that the cost of changing lane is less than the cost of being in the same lane at slower speed, the path planner executes a lane changing trajectory execution.

![alt text][image1]

### Video
Here's a video of the performance of MPC algorithm in the simulator
[![alt text][image4]](https://youtu.be/rmrhmMdB_hE)
